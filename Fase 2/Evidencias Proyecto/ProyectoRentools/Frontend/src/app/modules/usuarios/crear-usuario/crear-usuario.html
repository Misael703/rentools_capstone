<div class="container form-usuario">

  <!-- Título -->
  <h2 class="form-title">Crear Nuevo Usuario</h2>

  <!-- Mensaje de error -->
  <div *ngIf="mensajeError" class="alert alert-danger mt-2">{{ mensajeError }}</div>

  <form [formGroup]="form" (ngSubmit)="guardar()" class="usuario-form">

    <!-- Nombre -->
    <div class="form-group">
      <label>Nombre</label>
      <input type="text" formControlName="nombre" class="form-control" placeholder="Nombre" />
      <div class="text-danger" *ngIf="form.get('nombre')?.touched && form.get('nombre')?.invalid">
        El nombre es obligatorio.
      </div>
    </div>

    <!-- Email -->
    <div class="form-group">
      <label>Email</label>
      <input type="email" formControlName="email" class="form-control" placeholder="Correo electrónico" />
      <div class="text-danger" *ngIf="form.get('email')?.touched && form.get('email')?.invalid">
        <span *ngIf="form.get('email')?.errors?.['required']">El email es obligatorio.</span>
        <span *ngIf="form.get('email')?.errors?.['email']">El email no es válido.</span>
      </div>
    </div>

    <!-- Password -->
    <div class="form-group">
      <label>Password</label>
      <input type="password" formControlName="password" class="form-control" placeholder="Contraseña" />
      <div class="text-danger" *ngIf="form.get('password')?.touched && form.get('password')?.invalid">
        <span *ngIf="form.get('password')?.errors?.['required']">La contraseña es obligatoria.</span>
        <span *ngIf="form.get('password')?.errors?.['minlength']">Mínimo 6 caracteres.</span>
      </div>
    </div>

    <!-- Rol -->
    <div class="form-group">
      <label>Rol</label>
      <select formControlName="id_rol" class="form-control">
        <option value="">Seleccione un rol</option>
        <option *ngFor="let rol of roles" [value]="rol.id_rol">{{ rol.nombre }}</option>
      </select>
      <div class="text-danger" *ngIf="form.get('id_rol')?.touched && form.get('id_rol')?.invalid">
        Debe seleccionar un rol.
      </div>
    </div>

    <!-- Botones -->
    <div class="botones-acciones">
      <button type="button" class="btn-cancelar" (click)="cancelar()">Cancelar</button>

      <button type="submit" class="btn-crear" [disabled]="form.invalid || loading">
        <i class="bi bi-plus-lg me-1"></i> Crear Usuario
      </button>
    </div>

  </form>

  <!-- MODAL DE ÉXITO -->
  <div *ngIf="mostrarMensaje" class="mensaje-exito text-center">
    <div class="mb-3">
      <i class="bi bi-check-circle-fill icono-exito"></i>
    </div>
    <button class="btn-crear" (click)="cerrarMensaje()">¡Registro exitoso!</button>
  </div>

</div>