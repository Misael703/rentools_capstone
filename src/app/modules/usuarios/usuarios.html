<div class="container mt-4">

  <!-- Título y botón crear -->
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h2 class="fw-bold">Gestión Usuario</h2>
    <button class="btn btn-success d-flex align-items-center" (click)="crearUsuario()">
      <i class="bi bi-plus-lg me-2"></i> Crear Usuario
    </button>
  </div>

  <!-- Buscador -->
  <div class="mb-3 d-flex justify-content-start">
    <input type="text" class="form-control w-25" [(ngModel)]="terminoBusqueda" placeholder="Buscar usuario..." />
  </div>

  <!-- Tabla -->
  <table class="table table-bordered table-hover text-center">
    <thead>
      <tr class="table-header-title">
        <th colspan="6">Lista de Usuario</th>
      </tr>
      <tr class="table-header-columns">
        <th>ID</th>
        <th>Nombre</th>
        <th>Email</th>
        <th>Rol</th>
        <th>Estado</th>
        <th class="col-acciones">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of aplicarFiltro()">
        <td>{{ u.id_usuario }}</td>
        <td>{{ u.nombre }}</td>
        <td>{{ u.email }}</td>
        <td>{{ getRolNombre(u.id_rol) }}</td>
        <td>
          <span [ngClass]="u.activo ? 'text-success fw-bold' : 'text-danger fw-bold'">
            {{ u.activo ? 'Habilitado' : 'Deshabilitado' }}
          </span>
        </td>
        <td class="col-acciones">
          <!-- Editar -->
          <span class="action-icon bg-warning" (click)="editarUsuario(u)" title="Editar">
            <i class="bi bi-pencil-square"></i>
          </span>

          <!-- Deshabilitar -->
          <span class="action-icon bg-danger" *ngIf="u.activo" (click)="confirmarDeshabilitar(u)" title="Deshabilitar">
            <i class="bi bi-trash"></i>
          </span>

          <!-- Habilitar -->
          <span class="action-icon bg-success" *ngIf="!u.activo" (click)="confirmarHabilitar(u)" title="Habilitar">
            <i class="bi bi-check-lg"></i>
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal de confirmación -->
<div *ngIf="mostrarConfirmacion" class="mensaje-confirmacion text-center">
  <i class="bi bi-exclamation-triangle-fill text-warning check-icon"></i>
  <p class="fw-bold">{{ mensajeConfirmacion }}</p>
  <div class="mt-3">
    <button class="btn btn-secondary me-2" (click)="cancelarConfirmacion()">Cancelar</button>
    <button class="btn btn-primary" (click)="aceptarConfirmacion()">Aceptar</button>
  </div>
</div>

<!-- Mensaje de resultado -->
<div *ngIf="mostrarMensaje" class="mensaje-confirmacion text-center">
  <i [class]="iconoResultado + ' check-icon'"></i>
  <button class="btn btn-warning mt-3" (click)="cerrarMensaje()">{{ mensajeResultado }}</button>
</div>